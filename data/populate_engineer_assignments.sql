use green_line_records;

drop function if exists find_project_id;
DELIMITER //
create function find_project_id
  (
    project_title varchar(100)
  )
  returns int
  BEGIN
    return (select project_id from project where title like project_title limit 1);
  END //
DELIMITER ;

drop function if exists find_engineer_id;
DELIMITER //
-- NOTE: if there are multiple members with the same full name, this function cannot distinguish them --
create function find_engineer_id
  (
    first_name varchar(50),
    last_name  varchar(50)
  )
  returns int
  BEGIN
    return (select engineer_id
            from engineer e
            left join club_member c using (member_id)
            where c.firstname like first_name and c.lastname like last_name
            limit 1);
  END //
DELIMITER ;

insert into project_assignment
values (find_project_id('Mike Morrissey single'), find_engineer_id('Zac', 'Kerwin')),
       (find_project_id('Mike Morrissey single'), find_engineer_id('Gabriel', 'Pino')),
       (find_project_id('Mike Morrissey single'), find_engineer_id('Ryan', 'Busse')),
       (find_project_id('Mike Morrissey single'), find_engineer_id('Pavan', 'Hirpara')),
       (find_project_id('Leo Son & The Q-tip Bandits single'), find_engineer_id('Zac', 'Kerwin')),
       (find_project_id('Leo Son & The Q-tip Bandits single'), find_engineer_id('Mike', 'Econ')),
       (find_project_id('Leo Son & The Q-tip Bandits single'), find_engineer_id('Spencer',
                                                                                'Birch')),
       (find_project_id('Leo Son & The Q-tip Bandits single'), find_engineer_id('Christian',
                                                                                'Bobowicz')),
       (find_project_id('Leo Son & The Q-tip Bandits single'), find_engineer_id('Ben', 'Harrold')),
       (find_project_id('Leo Son & The Q-tip Bandits single'), find_engineer_id('Alex', 'Teitler')),
       (find_project_id('Henry Mccal single'), find_engineer_id('Zac', 'Kerwin')),
       (find_project_id('Henry Mccal single'), find_engineer_id('Greg', 'Leo')),
       (find_project_id('Henry Mccal single'), find_engineer_id('Spencer', 'Webb')),
       (find_project_id('Henry Mccal single'), find_engineer_id('Alia', 'Newman-Boulle')),
       (find_project_id('Henry Mccal single'), find_engineer_id('Bella', 'Raponi')),
       (find_project_id('Devvey single'), find_engineer_id('Zac', 'Kerwin')),
       (find_project_id('Devvey single'), find_engineer_id('Gabriel', 'Pino')),
       (find_project_id('Devvey single'), find_engineer_id('Hunter', 'Wenglikowski')),
       (find_project_id('Devvey single'), find_engineer_id('Nicholas', 'Harper')),
       (find_project_id('Devvey single'), find_engineer_id('James', 'Barden')),
       (find_project_id('Brandie Blaze single'), find_engineer_id('Zac', 'Kerwin')),
       (find_project_id('Brandie Blaze single'), find_engineer_id('Connor', 'Modugno')),
       (find_project_id('Brandie Blaze single'), find_engineer_id('Mina', 'Fletch')),
       (find_project_id('Brandie Blaze single'), find_engineer_id('Lucas', 'Espada')),
       (find_project_id('Brandie Blaze single'), find_engineer_id('Hannah', 'Lowicki')),
       (find_project_id('Maya Lucia EP'), find_engineer_id('Dan', 'Mulligan')),
       (find_project_id('Maya Lucia EP'), find_engineer_id('Walker', 'Lambrecht')),
       (find_project_id('Maya Lucia EP'), find_engineer_id('Jonathan', 'Prus')),
       (find_project_id('Maya Lucia EP'), find_engineer_id('Christina', 'Carol')),
       (find_project_id('Maya Lucia EP'), find_engineer_id('Vivienne', 'Gao')),
       (find_project_id('Twelveyes single'), find_engineer_id('Dan', 'Mulligan')),
       (find_project_id('Twelveyes single'), find_engineer_id('Mike', 'Econ')),
       (find_project_id('Twelveyes single'), find_engineer_id('Ryan', 'Busse')),
       (find_project_id('Twelveyes single'), find_engineer_id('Elias', 'Karikas')),
       (find_project_id('Twelveyes single'), find_engineer_id('Adam', 'Doucette')),
       (find_project_id('D $oundz single'), find_engineer_id('Walker', 'Lambrecht')),
       (find_project_id('D $oundz single'), find_engineer_id('Spencer', 'Birch')),
       (find_project_id('D $oundz single'), find_engineer_id('Simon', 'Aber')),
       (find_project_id('D $oundz single'), find_engineer_id('Adam', 'Doucette')),
       (find_project_id('D $oundz single'), find_engineer_id('Jared', 'Zimiroski')),
       (find_project_id('Avi Jacob single'), find_engineer_id('Cairo', 'Marques-Neto')),
       (find_project_id('Avi Jacob single'), find_engineer_id('Vivienne', 'Gao')),
       (find_project_id('Avi Jacob single'), find_engineer_id('Chuck', 'Stein')),
       (find_project_id('Avi Jacob single'), find_engineer_id('Christian', 'Bobowicz')),
       (find_project_id('Brennan single'), find_engineer_id('Zac', 'Kerwin')),
       (find_project_id('Brennan single'), find_engineer_id('Chris', 'Miller')),
       (find_project_id('Brennan single'), find_engineer_id('Kathryn', 'Theobalds')),
       (find_project_id('Brennan single'), find_engineer_id('Bella', 'Raponi')),
       (find_project_id('Brennan single'), find_engineer_id('Jonathan', 'Prus')),
       (find_project_id('Atlas Lab single'), find_engineer_id('Alex', 'Tran')),
       (find_project_id('3-song EP by Du Vide'), find_engineer_id('Alex', 'Tran')),
       (find_project_id('3-song EP by Du Vide'), find_engineer_id('Ethan', 'Finn')),
       (find_project_id('3-song EP by Du Vide'), find_engineer_id('Sam', 'Alatalo')),
       (find_project_id('3-song EP by Du Vide'), find_engineer_id('Kaitlyn', 'Dwyer')),
       (find_project_id('Maggie Whitlock single'), find_engineer_id('Alex', 'Tran')),
       (find_project_id('Maggie Whitlock single'), find_engineer_id('Ethan', 'Finn')),
       (find_project_id('Maggie Whitlock single'), find_engineer_id('Aleksandra', 'Pasek')),
       (find_project_id('Maggie Whitlock single'), find_engineer_id('Brooke', 'Elowe')),
       (find_project_id('Grace & The Carnivore EP'), find_engineer_id('Ben', 'Andre')),
       (find_project_id('Grey Season single'), find_engineer_id('Ben', 'Andre')),
       (find_project_id('Grey Season single'), find_engineer_id('Cliff', 'Bonner-Desravines')),
       (find_project_id('Claire Bryant single'), find_engineer_id('Cairo', 'Marques-Neto')),
       (find_project_id('Claire Bryant single'), find_engineer_id('Allie', 'Gurland')),
       (find_project_id('The Chestnuts single'), find_engineer_id('Cairo', 'Marques-Neto')),
       (find_project_id('The Chestnuts single'), find_engineer_id('Nick', 'Robinson')),
       (find_project_id('The Chestnuts single'), find_engineer_id('Olivia', 'Xu')),
       (find_project_id('(T-T)b EP'), find_engineer_id('Carson', 'Lewis')),
       (find_project_id('(T-T)b EP'), find_engineer_id('Paul', 'Kouris')),
       (find_project_id('The Rooks single'), find_engineer_id('Carson', 'Lewis')),
       (find_project_id('The Rooks single'), find_engineer_id('Andrew', 'Gifford')),
       (find_project_id('Venomous Whale album'), find_engineer_id('Carson', 'Lewis')),
       (find_project_id('Brittle Brian single'), find_engineer_id('Carson', 'Lewis')),
       (find_project_id('Brittle Brian single'), find_engineer_id('Micah', 'Travis')),
       (find_project_id('Karman Voh/Charles Perrone single'), find_engineer_id('Dillon',
                                                                               'Salkovitz')),
       (find_project_id('Karman Voh/Charles Perrone single'), find_engineer_id('Seth', 'Rosenau')),
       (find_project_id('Brave Elephant bonus tracks'), find_engineer_id('Emily', 'McCarthy')),
       (find_project_id('Brave Elephant bonus tracks'), find_engineer_id('Seth', 'Rosenau')),
       (find_project_id('Brave Elephant bonus tracks'), find_engineer_id('Melissa', 'Rorech')),
       (find_project_id('Brave Elephant bonus tracks'), find_engineer_id('Paul', 'Kouris')),
       (find_project_id('Dinoczar album'), find_engineer_id('Joey', 'Lafyatis')),
       (find_project_id('Dinoczar album'), find_engineer_id('Will', 'Clune')),
       (find_project_id('Brooke Elowe single'), find_engineer_id('Josh', 'Bernstein')),
       (find_project_id('Kaeli Earle single'), find_engineer_id('Melissa', 'Rorech')),
       (find_project_id('Kaeli Earle single'), find_engineer_id('Nick', 'Leonard')),
       (find_project_id('Kaeli Earle single'), find_engineer_id('Cienna', 'Dubay')),
       (find_project_id('Kaeli Earle single'), find_engineer_id('Jeewan', 'Ambat')),
       (find_project_id('Houseguests live studio single'), find_engineer_id('Michael', 'Orent')),
       (find_project_id('Houseguests live studio single'), find_engineer_id('Seth', 'Rosenau')),
       (find_project_id('Houseguests live studio single'), find_engineer_id('Jacob', 'Samson')),
       (find_project_id('Houseguests live studio single'), find_engineer_id('Hussain', 'Hamoudi')),
       (find_project_id('Houseguests live studio single'), find_engineer_id('Chris', 'Miller')),
       (find_project_id('Houseguests live studio single'), find_engineer_id('Aleksandra', 'Pasek')),
       (find_project_id('Atlas Lab unidentified project engineered by Michelle Houle'),
        find_engineer_id('Michelle', 'Houle')),
       (find_project_id('Atlas Lab unidentified project engineered by Michelle Houle'),
        find_engineer_id('Ethan', 'Finn')),
       (find_project_id('Able Days single'), find_engineer_id('Paul', 'Kouris')),
       (find_project_id('Able Days single'), find_engineer_id('Michael', 'Orent')),
       (find_project_id('Pet Jail live studio single'), find_engineer_id('Paul', 'Kouris')),
       (find_project_id('Pet Jail live studio single'), find_engineer_id('Rob', 'Steiner')),
       (find_project_id('Pet Jail live studio single'), find_engineer_id('Denzil', 'Leach')),
       (find_project_id('Pet Jail live studio single'), find_engineer_id('Dante', 'Marino')),
       (find_project_id('Bedbug single'), find_engineer_id('Michael', 'Orent')),
       (find_project_id('Bedbug single'), find_engineer_id('Micah', 'Travis')),
       (find_project_id('Sam Haiman Band single'), find_engineer_id('Melissa', 'Rorech')),
       (find_project_id('Migrant Motel single'), find_engineer_id('Melissa', 'Rorech')),
       (find_project_id('Take Care'), find_engineer_id('Seth', 'Rosenau')),
       (find_project_id('Take Care'), find_engineer_id('Joseph', 'Newmann')),
       (find_project_id('Take Care'), find_engineer_id('Nick', 'Leonard')),
       (find_project_id('Take Care'), find_engineer_id('Joshua', 'Garvey')),
       (find_project_id('Able Days EP'), find_engineer_id('Paul', 'Kouris')),
       (find_project_id('Able Days EP'), find_engineer_id('Michael', 'Orent')),
       (find_project_id('Able Days EP'), find_engineer_id('Nick', 'Smith')),
       (find_project_id('Able Days EP'), find_engineer_id('Kyle', 'McCrosson')),
       (find_project_id('Able Days EP'), find_engineer_id('Henry', 'Gridley')),
       (find_project_id('the seams'), find_engineer_id('Paul', 'Kouris')),
       (find_project_id('the seams'), find_engineer_id('Nick', 'Smith')),
       (find_project_id('the seams'), find_engineer_id('Rachel', 'Lipson')),
       (find_project_id('the seams'), find_engineer_id('Hayley', 'Kuhlmann')),
       (find_project_id('the seams'), find_engineer_id('Craig', 'Short')),
       (find_project_id('Your Book'), find_engineer_id('Dan', 'Mulligan')),
       (find_project_id('Your Book'), find_engineer_id('Denzil', 'Leach')),
       (find_project_id('Your Book'), find_engineer_id('Nick', 'Smith')),
       (find_project_id('Your Book'), find_engineer_id('Joshua', 'Garvey')),
       (find_project_id('Your Book'), find_engineer_id('Hussain', 'Hamoudi')),
       (find_project_id('Flamingo Club single'), find_engineer_id('Joseph', 'Newmann')),
       (find_project_id('Flamingo Club single'), find_engineer_id('Craig', 'Short')),
       (find_project_id('Flamingo Club single'), find_engineer_id('Thomas', 'Ward')),
       (find_project_id('Flamingo Club single'), find_engineer_id('Hussain', 'Hamoudi')),
       (find_project_id('Systematic single'), find_engineer_id('Cienna', 'Dubay')),
       (find_project_id('Systematic single'), find_engineer_id('Kevin', 'Mendez')),
       (find_project_id('Systematic single'), find_engineer_id('Joseph', 'Newmann')),
       (find_project_id('Systematic single'), find_engineer_id('Hussain', 'Hamoudi')),
       (find_project_id('Systematic single'), find_engineer_id('Joshua', 'Garvey')),
       (find_project_id('Mandy Kessler single'), find_engineer_id('Cienna', 'Dubay')),
       (find_project_id('Mandy Kessler single'), find_engineer_id('Nathan', 'Newbury')),
       (find_project_id('Mandy Kessler single'), find_engineer_id('Erika', 'Hansen')),
       (find_project_id('Trevor Dering single'), find_engineer_id('Joseph', 'Newmann')),
       (find_project_id('Trevor Dering single'), find_engineer_id('Austin', 'Henry')),
       (find_project_id('Trevor Dering single'), find_engineer_id('Cassidy', 'Pelletier')),
       (find_project_id('Trevor Dering single'), find_engineer_id('Rohan', 'Upadhyayula')),
       (find_project_id('Sugar'), find_engineer_id('Joseph', 'Newmann')),
       (find_project_id('Sugar'), find_engineer_id('Zac', 'Kerwin')),
       (find_project_id('Sugar'), find_engineer_id('John', 'Calli')),
       (find_project_id('Sugar'), find_engineer_id('Chuck', 'Stein')),
       (find_project_id('a tale from tomorrow'), find_engineer_id('Paul', 'Kouris')),
       (find_project_id('a tale from tomorrow'), find_engineer_id('Tristan', 'Smith')),
       (find_project_id('a tale from tomorrow'), find_engineer_id('Akhil', 'Bollu')),
       (find_project_id('a tale from tomorrow'), find_engineer_id('Chuck', 'Stein')),
       (find_project_id('a tale from tomorrow'), find_engineer_id('William', 'Kast')),
       (find_project_id('Old Enough'), find_engineer_id('Melissa', 'Rorech')),
       (find_project_id('Old Enough'), find_engineer_id('Rob', 'Steiner')),
       (find_project_id('Old Enough'), find_engineer_id('Emily', 'Burke')),
       (find_project_id('Old Enough'), find_engineer_id('Joseph', 'Callaghan')),
       (find_project_id('Old Enough'), find_engineer_id('Emmett', 'Dwyer')),
       (find_project_id('Give It Up'), find_engineer_id('Cairo', 'Marques-Neto')),
       (find_project_id('Give It Up'), find_engineer_id('Nick', 'Leonard')),
       (find_project_id('Give It Up'), find_engineer_id('Thomas', 'Hinds')),
       (find_project_id('Give It Up'), find_engineer_id('Emily', 'Burke')),
       (find_project_id('Give It Up'), find_engineer_id('Greg', 'Leo')),
       (find_project_id('Heart of the Sun'), find_engineer_id('Paul', 'Kouris')),
       (find_project_id('Heart of the Sun'), find_engineer_id('Aleksandra', 'Pasek')),
       (find_project_id('Heart of the Sun'), find_engineer_id('Lauren', 'Oldefendt')),
       (find_project_id('Heart of the Sun'), find_engineer_id('Zac', 'Kerwin')),
       (find_project_id('Heart of the Sun'), find_engineer_id('Emmett', 'Dwyer')),
       (find_project_id('Cruel Miracle single'), find_engineer_id('Nick', 'Leonard')),
       (find_project_id('Cruel Miracle single'), find_engineer_id('Nick', 'Kaffine')),
       (find_project_id('Cruel Miracle single'), find_engineer_id('Bryce', 'Krause')),
       (find_project_id('Cruel Miracle single'), find_engineer_id('Lauren', 'Oldefendt')),
       (find_project_id('Time Out of Mind'), find_engineer_id('Dan', 'Mulligan')),
       (find_project_id('Time Out of Mind'), find_engineer_id('Nick', 'Smith')),
       (find_project_id('Time Out of Mind'), find_engineer_id('Zac', 'Kerwin')),
       (find_project_id('Time Out of Mind'), find_engineer_id('Emily', 'Burke')),
       (find_project_id('Time Out of Mind'), find_engineer_id('Joseph', 'Callaghan')),
       (find_project_id('~*Angry 4evr*~'), find_engineer_id('Craig', 'Short')),
       (find_project_id('~*Angry 4evr*~'), find_engineer_id('Hayley', 'Kuhlmann')),
       (find_project_id('~*Angry 4evr*~'), find_engineer_id('Rachel', 'Lipson')),
       (find_project_id('~*Angry 4evr*~'), find_engineer_id('Casper', 'Pelletier')),
       (find_project_id('~*Angry 4evr*~'), find_engineer_id('Dell', 'Benjamin')),
       (find_project_id('~*Angry 4evr*~'), find_engineer_id('Gabriel', 'Pino')),
       (find_project_id('frog.png'), find_engineer_id('Melissa', 'Rorech')),
       (find_project_id('frog.png'), find_engineer_id('Zac', 'Kerwin')),
       (find_project_id('frog.png'), find_engineer_id('Greg', 'Leo')),
       (find_project_id('frog.png'), find_engineer_id('Sam', 'Baumgartel')),
       (find_project_id('frog.png'), find_engineer_id('Elliot', 'Efrat')),
       (find_project_id('Till You Run Out of Time'), find_engineer_id('Nick', 'Leonard')),
       (find_project_id('Till You Run Out of Time'), find_engineer_id('Craig', 'Short')),
       (find_project_id('Till You Run Out of Time'), find_engineer_id('Rohan', 'Upadhyayula')),
       (find_project_id('Till You Run Out of Time'), find_engineer_id('Greg', 'Leo')),
       (find_project_id('Till You Run Out of Time'), find_engineer_id('Thomas', 'Hinds')),
       (find_project_id('NU Stage single'), find_engineer_id('Craig', 'Short')),
       (find_project_id('NU Stage single'), find_engineer_id('Emily', 'Burke')),
       (find_project_id('NU Stage single'), find_engineer_id('Joey', 'Molloy')),
       (find_project_id('NU Stage single'), find_engineer_id('Rayven', 'Tate')),
       (find_project_id('I Have No Time'), find_engineer_id('Dan', 'Mulligan')),
       (find_project_id('I Have No Time'), find_engineer_id('Emily', 'Burke')),
       (find_project_id('I Have No Time'), find_engineer_id('Sam', 'Baumgartel')),
       (find_project_id('I Have No Time'), find_engineer_id('Akhil', 'Bollu')),
       (find_project_id('I Have No Time'), find_engineer_id('Miles', 'Ragan')),
       (find_project_id('Reckless'), find_engineer_id('Aleksandra', 'Pasek')),
       (find_project_id('Reckless'), find_engineer_id('Craig', 'Short')),
       (find_project_id('Reckless'), find_engineer_id('Miles', 'Ragan')),
       (find_project_id('Reckless'), find_engineer_id('Rohan', 'Upadhyayula')),
       (find_project_id('Reckless'), find_engineer_id('Jaime', 'Gomez Diez')),
       (find_project_id('Cosmic Johnny single'), find_engineer_id('Melissa', 'Rorech')),
       (find_project_id('Cosmic Johnny single'), find_engineer_id('Rachel', 'Lipson')),
       (find_project_id('Cosmic Johnny single'), find_engineer_id('Sagar', 'Kumar')),
       (find_project_id('Broken by the Fix'), find_engineer_id('Rachel', 'Lipson')),
       (find_project_id('Broken by the Fix'), find_engineer_id('Aleksandra', 'Pasek')),

       (find_project_id('NU Songwriting Club Compilation 2018'), find_engineer_id('Craig',
                                                                                  'Short')),
       (find_project_id('NU Songwriting Club Compilation 2018'), find_engineer_id('Akhil',
                                                                                  'Bollu')),
       (find_project_id('NU Songwriting Club Compilation 2018'), find_engineer_id('Bryce',
                                                                                  'Krause')),
       (find_project_id('NU Songwriting Club Compilation 2018'), find_engineer_id('Gabriella',
                                                                                  'Dechabot')),
       (find_project_id('NU Songwriting Club Compilation 2018'), find_engineer_id('Tristan',
                                                                                  'Smith')),
       (find_project_id('NU Songwriting Club Compilation 2018'), find_engineer_id('Dell',
                                                                                  'Benjamin')),
       (find_project_id('NU Songwriting Club Compilation 2018'), find_engineer_id('Gabriel',
                                                                                  'Pino')),
       (find_project_id('NU Songwriting Club Compilation 2018'), find_engineer_id('Sagar',
                                                                                  'Kumar')),
       (find_project_id('NU Songwriting Club Compilation 2018'), find_engineer_id('Cienna',
                                                                                  'Dubay')),
       (find_project_id('NU Songwriting Club Compilation 2018'), find_engineer_id('Rayven',
                                                                                  'Tate')),
       (find_project_id('NU Songwriting Club Compilation 2018'), find_engineer_id('Lauren',
                                                                                  'Oldefendt')),
       (find_project_id('NU Songwriting Club Compilation 2018'), find_engineer_id('Nell',
                                                                                  'Snow')),
       (find_project_id('NU Songwriting Club Compilation 2018'), find_engineer_id('Dia',
                                                                                  'Papa')),
       (find_project_id('NU Songwriting Club Compilation 2018'), find_engineer_id('Hayley',
                                                                                  'Kuhlmann')),
       (find_project_id('NU Songwriting Club Compilation 2018'), find_engineer_id('John',
                                                                                  'Calli')),
       (find_project_id('NU Songwriting Club Compilation 2018'), find_engineer_id('Thomas',
                                                                                  'Hinds')),
       (find_project_id('NU Songwriting Club Compilation 2018'), find_engineer_id('Jake',
                                                                                  'Poulios')),
       (find_project_id('NU Songwriting Club Compilation 2018'), find_engineer_id('Greg',
                                                                                  'Leo')),
       (find_project_id('NU Songwriting Club Compilation 2018'), find_engineer_id('Austin',
                                                                                  'Henry')),
       (find_project_id('NU Songwriting Club Compilation 2018'), find_engineer_id('Emily',
                                                                                  'Burke')),
       (find_project_id('NU Songwriting Club Compilation 2018'), find_engineer_id('Arabella',
                                                                                  'Berman')),
       (find_project_id('NU Songwriting Club Compilation 2018'), find_engineer_id('Eli',
                                                                                  'Olson')),
       (find_project_id('NU Songwriting Club Compilation 2018'), find_engineer_id('Joseph',
                                                                                  'Callaghan')),
       (find_project_id('NU Songwriting Club Compilation 2018'), find_engineer_id('Aleksandra',
                                                                                  'Pasek')),
       (find_project_id('NU Songwriting Club Compilation 2018'), find_engineer_id('Maya',
                                                                                  'Roberts')),
       (find_project_id('NU Songwriting Club Compilation 2018'), find_engineer_id('Zac',
                                                                                  'Kerwin')),
       (find_project_id('NU Songwriting Club Compilation 2018'), find_engineer_id('Ryan',
                                                                                  'Harrigan')),
       (find_project_id('NU Songwriting Club Compilation 2018'), find_engineer_id('Chuck',
                                                                                  'Stein')),
       (find_project_id('NU Songwriting Club Compilation 2018'), find_engineer_id('Elliot',
                                                                                  'Efrat')),
       (find_project_id('NU Songwriting Club Compilation 2018'), find_engineer_id('Candace',
                                                                                  'Reyes'));





